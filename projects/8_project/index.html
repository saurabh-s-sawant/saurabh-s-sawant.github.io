<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> <span style="text-transform:uppercase;">M</span>odal <span style="text-transform:uppercase;">A</span>nalysis in <span style="text-transform:uppercase;">P</span>arallel | Saurabh S. Sawant </title> <meta name="author" content="Saurabh S. Sawant"> <meta name="description" content="A parallel solver using C++ and LAPACK for proper orthogonal and dynamic mode decomposition using communication reducing tall and skinny QR (TSQR) factorization algorithm"> <meta name="keywords" content="saurabh-s-sawant, saurabh-sawant, portfolio, website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://saurabh-s-sawant.github.io/projects/8_project/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Saurabh </span> S.  Sawant </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Research <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title"> <span style="text-transform:uppercase;">M</span>odal <span style="text-transform:uppercase;">A</span>nalysis in <span style="text-transform:uppercase;">P</span>arallel</h1> <p class="post-description">A parallel solver using C++ and LAPACK for proper orthogonal and dynamic mode decomposition using communication reducing tall and skinny QR (TSQR) factorization algorithm</p> </header> <article> <div align="justify"> Modal decomposition serves as a valuable tool for understanding complex fluid flow phenomena. It involves breaking down the solution into individual modes or patterns, each representing unique spatial structures or oscillatory behaviors within the flow. This decomposition allows for the identification of dominant patterns, extraction of pertinent information, and potential simplification of flow field representation. </div> <div align="justify"> <br> Methods like proper orthogonal decomposition (POD) are commonly employed to filter noise in images and videos or to reduce their size while retaining dominant features. Numerous variations of this algorithm exist, with many online videos providing explanations and demonstrations with interesting examples. One notable application of modal decomposition is in noise reduction. </div> <div align="justify"> <br> In my Ph.D. research, which heavily relied on the Direct Simulation Monte Carlo (DSMC) method, noise was a significant factor, especially in scenarios involving linear instabilities like those explored in the <a href="https://saurabh-s-sawant.github.io/projects/3_project/">Laminar Separation Bubble Instability</a> project. Here, modal decomposition techniques such as proper orthogonal decomposition proved invaluable in understanding the early manifestation of the instabilily. </div> <div align="justify"> <br> The POD method involves performing singular value decomposition (SVD) on a matrix, where the rows correspond to the number of solution points and the columns represent the number of temporal snapshots at which the data is captured. In the realm of 3D simulations, the sheer number of simulation points can be substantial; for instance, even my 'coarsest mesh' consisted of millions of computational cells representing spatial variation of solution. Conversely, the number of time snapshots tends to be relatively low, typically on the order of thousands. </div> <div align="justify"> <br> This scenario presents a computational challenge: conducting SVD on a matrix that is 'tall and skinny,' meaning it has significantly more rows than columns. Moreover, this operation must be executed in parallel, as the entire matrix cannot be accommodated on a single node of a supercomputer. </div> <div align="justify"> <br> To address this challenge, I developed a parallel solver for POD using C++ and the message passing interface (MPI). The solver employs a communication-reducing algorithm known as the Tall and Skinny QR (TSQR) factorization algorithm, developed by <a href="https://epubs.siam.org/doi/10.1137/080731992" rel="external nofollow noopener" target="_blank">Demmel et al.</a>. You can find the implementation on GitHub at the following <a href="https://github.com/saurabh-s-sawant/POD_DMD" rel="external nofollow noopener" target="_blank">Github link</a>. </div> <div align="justify"> <br> Figure (1) shows an example of using POD to filter DSMC noise <a class="citation" href="#sawant_doublewedge_2022">(Sawant et al., 2022)</a>. The POD-reconstructed data exhibits the same spatial spanwise variation but contains very low statistical noise compared with the DSMC solution. The size of matrix for each flow parameter was <strong>24 million x 400</strong>. </div> <p><br></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/dmd/uy_OrigPODCompare-480.webp 480w,/assets/img/projects/dmd/uy_OrigPODCompare-800.webp 800w,/assets/img/projects/dmd/uy_OrigPODCompare-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/dmd/uy_OrigPODCompare.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/dmd/uy_1DPODCompare-480.webp 480w,/assets/img/projects/dmd/uy_1DPODCompare-800.webp 800w,/assets/img/projects/dmd/uy_1DPODCompare-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/dmd/uy_1DPODCompare.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <div align="justify"> Fig. 1. (a) Contours of raw DSMC field on plane R, defined in Fig. (2) of <a href="https://saurabh-s-sawant.github.io/projects/3_project/">Laminar Separation Bubble Instability</a>. Overlaid lines are noise-filtered reconstruction of the field using two most dominant POD modes. (b) Comparison of DSMC (unfiltered) and POD (filtered) field along lines L<sub>1</sub> and L<sub>2</sub> denoted in (a). </div> </div> <div align="justify"> <br> The code was further extended to include dynamic mode decomposition (DMD), an algorithm that has been widely utilized since its inception by <a href="https://doi.org/10.1017/S0022112010001217" rel="external nofollow noopener" target="_blank">Schmid, P.J.</a>. Parallelization of this algorithm is described by <a href="https://link.springer.com/article/10.1007/s00162-016-0385-x" rel="external nofollow noopener" target="_blank">Sayadi, T. &amp; Schmid, P.J.</a>. However, I never ended up using it in my research. As a validation of my code, consider this example from the book <a href="https://epubs.siam.org/doi/book/10.1137/1.9781611974508" rel="external nofollow noopener" target="_blank">Dynamic Mode Decomposition</a> by Kutz et al.. Let f be composed of two decaying functions, \begin{equation} f_1 = \Re\left[ \text{sech}(x+3) \exp{(-0.1 t + i 2.3t)}\right] \end{equation} \begin{equation} f_2 = \Re\left[ \frac{2 sech(x)}{tanh(x)} \exp{(-0.2t + i 2.8t)}\right] \end{equation} Applying DMD to f for modal decomposition correctly recovers underlying eigenvectors and eigenvalues. </div> <p><br></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/dmd/f_orig-480.webp 480w,/assets/img/projects/dmd/f_orig-800.webp 800w,/assets/img/projects/dmd/f_orig-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/dmd/f_orig.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/dmd/eigenvectors-480.webp 480w,/assets/img/projects/dmd/eigenvectors-800.webp 800w,/assets/img/projects/dmd/eigenvectors-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/dmd/eigenvectors.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/dmd/eigenvalues-480.webp 480w,/assets/img/projects/dmd/eigenvalues-800.webp 800w,/assets/img/projects/dmd/eigenvalues-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/dmd/eigenvalues.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <div align="justify"> Fig. 1. (a) Function f=f<sub>1</sub> + f<sub>2</sub>. (b) Eigenvectors and (c) continuous time eigenvalues obtained from the DMD algorithm. </div> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Saurabh S. Sawant. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>